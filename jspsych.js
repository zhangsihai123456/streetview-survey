/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/jspsych@8.2.2/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import e from"/npm/auto-bind@4.0.0/+esm";import t from"/npm/random-words@1.3.0/+esm";import s from"/npm/seedrandom@3.0.5/lib/alea.js/+esm";class i{constructor(e,t){this.dependencies=e,this.extensionsConfiguration=t,this.extensions=Object.fromEntries(t.map((e=>[i.getExtensionNameByClass(e.type),this.dependencies.instantiateExtension(e.type)])))}static getExtensionNameByClass(e){return e.info.name}getExtensionInstanceByClass(e){return this.extensions[i.getExtensionNameByClass(e)]}async initializeExtensions(){await Promise.all(this.extensionsConfiguration.map((({type:e,params:t={}})=>{this.getExtensionInstanceByClass(e).initialize(t);const s=e.info;"version"in s||"data"in s?"version"in s?"data"in s||console.warn(s.name,"is missing the 'data' field. Please update extension as 'data' will be required in v9. See https://www.jspsych.org/latest/developers/extension-development/ for more details."):console.warn(s.name,"is missing the 'version' field. Please update extension as 'version' will be required in v9. See https://www.jspsych.org/latest/developers/extension-development/ for more details."):console.warn(s.name,"is missing the 'version' and 'data' fields. Please update extension as 'version' and 'data' will be required in v9. See https://www.jspsych.org/latest/developers/extension-development/ for more details.")})))}onStart(e=[]){for(const{type:t,params:s}of e)this.getExtensionInstanceByClass(t)?.on_start(s)}onLoad(e=[]){for(const{type:t,params:s}of e)this.getExtensionInstanceByClass(t)?.on_load(s)}async onFinish(e=[]){const t=await Promise.all(e.map((({type:e,params:t})=>Promise.resolve(this.getExtensionInstanceByClass(e)?.on_finish(t))))),s=e.length?{extension_type:e.map((({type:e})=>e.info.name)),extension_version:e.map((({type:e})=>e.info.version))}:{};return t.unshift(s),Object.assign({},...t)}}function n(e){return[...new Set(e)]}function r(e){if(!e)return e;let t;if(Array.isArray(e)){t=[];for(const s of e)t.push(r(s));return t}if("object"==typeof e&&null!==e){t={};for(const s in e)e.hasOwnProperty(s)&&(t[s]=r(e[s]));return t}return e}function a(e,t){let s={};for(const i in e)e.hasOwnProperty(i)&&("object"==typeof e[i]&&t.hasOwnProperty(i)?s[i]=a(e[i],t[i]):s[i]=e[i]);for(const e in t)t.hasOwnProperty(e)&&(s.hasOwnProperty(e)&&"object"==typeof t[e]?s[e]=a(s[e],t[e]):s[e]=t[e]);return s}var o=Object.freeze({__proto__:null,deepCopy:r,deepMerge:a,unique:n});class l{constructor(e=[]){this.values=e}sum(){let e=0;for(const t of this.values)e+=t;return e}mean(){let e=0,t=0;for(const s of this.values)null!=s&&(e+=s,t++);if(0!==t)return e/t}median(){if(0===this.values.length)return;const e=this.values.slice(0).sort((function(e,t){return e-t})),t=Math.floor(e.length/2);return e.length%2==0?(e[t]+e[t-1])/2:e[t]}min(){return Math.min.apply(null,this.values)}max(){return Math.max.apply(null,this.values)}count(){return this.values.length}variance(){const e=this.mean();let t=0;for(const s of this.values)t+=Math.pow(s-e,2);return t/(this.values.length-1)}sd(){const e=this.variance();return Math.sqrt(e)}frequencies(){const e={};for(const t of this.values)void 0===e[t]?e[t]=1:e[t]++;return e}all(e){for(const t of this.values)if(!e(t))return!1;return!0}subset(e){const t=[];for(const s of this.values)e(s)&&t.push(s);return new l(t)}}class h{constructor(e=[]){this.trials=e}push(e){return this.trials.push(e),this}join(e){return this.trials=this.trials.concat(e.values()),this}top(){return this.trials.length<=1?this:new h([this.trials[this.trials.length-1]])}first(e=1){if(e<1)throw"You must query with a positive nonzero integer. Please use a\n               different value for n.";return 0===this.trials.length?new h:(e>this.trials.length&&(e=this.trials.length),new h(this.trials.slice(0,e)))}last(e=1){if(e<1)throw"You must query with a positive nonzero integer. Please use a\n               different value for n.";return 0===this.trials.length?new h:(e>this.trials.length&&(e=this.trials.length),new h(this.trials.slice(this.trials.length-e,this.trials.length)))}values(){return this.trials}count(){return this.trials.length}readOnly(){return new h(r(this.trials))}addToAll(e){for(const t of this.trials)Object.assign(t,e);return this}addToLast(e){return this.trials.length>0&&Object.assign(this.trials[this.trials.length-1],e),this}filter(e){let t;t=Array.isArray(e)?r(e):r([e]);const s=[];for(const e of this.trials){let i=!1;for(const s of t){let t=!0;for(const i of Object.keys(s))void 0!==e[i]&&e[i]===s[i]||(t=!1);if(t){i=!0;break}}i&&s.push(e)}return new h(s)}filterCustom(e){return new h(this.trials.filter(e))}filterColumns(e){return new h(this.trials.map((t=>Object.fromEntries(e.filter((e=>e in t)).map((e=>[e,t[e]]))))))}select(e){const t=[];for(const s of this.trials)void 0!==s[e]&&t.push(s[e]);return new l(t)}ignore(e){Array.isArray(e)||(e=[e]);const t=r(this.trials);for(const s of t)for(const t of e)delete s[t];return new h(t)}uniqueNames(){const e=[];for(const t of this.trials)for(const s of Object.keys(t))e.includes(s)||e.push(s);return e}csv(){return function(e){const t="object"!=typeof e?JSON.parse(e):e;let s="",i="";const n=[];for(const e of t)for(const t in e){let e=t+"";e='"'+e.replace(/"/g,'""')+'",',n.includes(t)||(n.push(t),s+=e)}s=s.slice(0,-1),i+=s+"\r\n";for(const e of t){s="";for(const t of n){let i=void 0===e[t]?"":e[t];"object"==typeof i&&(i=JSON.stringify(i)),s+='"'+(i+"").replace(/"/g,'""')+'",'}s=s.slice(0,-1),i+=s+"\r\n"}return i}(this.trials)}json(e=!1){return e?JSON.stringify(this.trials,null,"\t"):JSON.stringify(this.trials)}localSave(e,t){let s;if("json"===(e=e.toLowerCase()))s=this.json();else{if("csv"!==e)throw new Error('Invalid format specified for localSave. Must be "json" or "csv".');s=this.csv()}!function(e,t){const s=new Blob([e],{type:"text/plain"});let i="";i=void 0!==window.webkitURL?window.webkitURL.createObjectURL(s):window.URL.createObjectURL(s);const n=document.createElement("a");n.id="jspsych-download-as-text-link",n.style.display="none",n.download=t,n.href=i,n.click()}(s,t)}}class u{constructor(e){this.dependencies=e,this.dataProperties={},this.interactionListeners={blur:()=>{this.addInteractionRecord("blur")},focus:()=>{this.addInteractionRecord("focus")},fullscreenchange:()=>{this.addInteractionRecord(document.isFullScreen||document.webkitIsFullScreen||document.mozIsFullScreen||document.fullscreenElement?"fullscreenenter":"fullscreenexit")}},this.reset()}reset(){this.results=new h,this.resultToTrialMap=new WeakMap,this.interactionRecords=new h}get(){return this.results}getInteractionData(){return this.interactionRecords}write(e){const t=e.getResult();Object.assign(t,this.dataProperties),this.results.push(t),this.resultToTrialMap.set(t,e)}addProperties(e){this.results.addToAll(e),this.dataProperties=Object.assign({},this.dataProperties,e)}addDataToLastTrial(e){this.results.addToLast(e)}getLastTrialData(){return this.results.top()}getLastTimelineData(){const e=this.getLastTrialData().values()[0];return new h(e?this.resultToTrialMap.get(e).parent.getResults():[])}displayData(e="json"){"json"!==(e=e.toLowerCase())&&"csv"!==e&&(console.log("Invalid format declared for displayData function. Using json as default."),e="json");const t=document.createElement("pre");t.id="jspsych-data-display",t.textContent="json"===e?this.results.json(!0):this.results.csv(),this.dependencies.getDisplayElement().replaceChildren(t)}urlVariables(){return void 0===this.query_string&&(this.query_string=function(){const e=window.location.search.substr(1).split("&"),t={};for(let s=0;s<e.length;++s){const i=e[s].split("=",2);1==i.length?t[i[0]]="":t[i[0]]=decodeURIComponent(i[1].replace(/\+/g," "))}return t}()),this.query_string}getURLVariable(e){return this.urlVariables()[e]}addInteractionRecord(e){const t={event:e,...this.dependencies.getProgress()};this.interactionRecords.push(t),this.dependencies.onInteractionRecordAdded(t)}createInteractionListeners(){window.addEventListener("blur",this.interactionListeners.blur),window.addEventListener("focus",this.interactionListeners.focus),document.addEventListener("fullscreenchange",this.interactionListeners.fullscreenchange),document.addEventListener("mozfullscreenchange",this.interactionListeners.fullscreenchange),document.addEventListener("webkitfullscreenchange",this.interactionListeners.fullscreenchange)}removeInteractionListeners(){window.removeEventListener("blur",this.interactionListeners.blur),window.removeEventListener("focus",this.interactionListeners.focus),document.removeEventListener("fullscreenchange",this.interactionListeners.fullscreenchange),document.removeEventListener("mozfullscreenchange",this.interactionListeners.fullscreenchange),document.removeEventListener("webkitfullscreenchange",this.interactionListeners.fullscreenchange)}}class c{constructor(t,s=!1,i=0){this.getRootElement=t,this.areResponsesCaseSensitive=s,this.minimumValidRt=i,this.listeners=new Set,this.heldKeys=new Set,this.areRootListenersRegistered=!1,e(this),this.registerRootListeners()}registerRootListeners(){if(!this.areRootListenersRegistered){const e=this.getRootElement();e&&(e.addEventListener("keydown",this.rootKeydownListener),e.addEventListener("keyup",this.rootKeyupListener),this.areRootListenersRegistered=!0)}}rootKeydownListener(e){for(const t of[...this.listeners])t(e);this.heldKeys.add(this.toLowerCaseIfInsensitive(e.key))}toLowerCaseIfInsensitive(e){return this.areResponsesCaseSensitive?e:e.toLowerCase()}rootKeyupListener(e){this.heldKeys.delete(this.toLowerCaseIfInsensitive(e.key))}isResponseValid(e,t,s){return!(!t&&this.heldKeys.has(s))&&("ALL_KEYS"===e||"NO_KEYS"!==e&&e.includes(s))}getKeyboardResponse({callback_function:e,valid_responses:t="ALL_KEYS",rt_method:s="performance",persist:i,audio_context:n,audio_context_start_time:r,allow_held_key:a=!1,minimum_valid_rt:o=this.minimumValidRt}){"performance"!==s&&"audio"!==s&&(console.log('Invalid RT method specified in getKeyboardResponse. Defaulting to "performance" method.'),s="performance");const l="performance"===s?performance.now():1e3*r;this.registerRootListeners(),this.areResponsesCaseSensitive||"string"==typeof t||(t=t.map((e=>e.toLowerCase())));const h=r=>{const u=Math.round(("performance"==s?performance.now():1e3*n.currentTime)-l);if(u<o)return;const c=this.toLowerCaseIfInsensitive(r.key);this.isResponseValid(t,a,c)&&(r.preventDefault(),i||this.cancelKeyboardResponse(h),e({key:r.key,rt:u}))};return this.listeners.add(h),h}cancelKeyboardResponse(e){this.listeners.delete(e)}cancelAllKeyboardResponses(){this.listeners.clear()}compareKeys(e,t){if(!("string"!=typeof e&&null!==e||"string"!=typeof t&&null!==t))return"string"==typeof e&&"string"==typeof t?this.areResponsesCaseSensitive?e===t:e.toLowerCase()===t.toLowerCase():null===e&&null===t;console.error("Error in jsPsych.pluginAPI.compareKeys: arguments must be key strings or null.")}}var d=(e=>(e[e.BOOL=0]="BOOL",e[e.STRING=1]="STRING",e[e.INT=2]="INT",e[e.FLOAT=3]="FLOAT",e[e.FUNCTION=4]="FUNCTION",e[e.KEY=5]="KEY",e[e.KEYS=6]="KEYS",e[e.SELECT=7]="SELECT",e[e.HTML_STRING=8]="HTML_STRING",e[e.IMAGE=9]="IMAGE",e[e.AUDIO=10]="AUDIO",e[e.VIDEO=11]="VIDEO",e[e.OBJECT=12]="OBJECT",e[e.COMPLEX=13]="COMPLEX",e[e.TIMELINE=14]="TIMELINE",e))(d||{});class p{constructor(e,t={useWebAudio:!1}){this.src=e,this.useWebAudio=t.useWebAudio,this.audioContext=t.audioContext||null}async load(){this.useWebAudio?this.webAudioBuffer=await this.preloadWebAudio(this.src):this.audio=await this.preloadHTMLAudio(this.src)}play(){this.audio instanceof HTMLAudioElement?this.audio.play():(this.audio||(this.audio=this.getAudioSourceNode(this.webAudioBuffer)),this.audio.start())}stop(){this.audio instanceof HTMLAudioElement?(this.audio.pause(),this.audio.currentTime=0):(this.audio.stop(),this.audio=this.getAudioSourceNode(this.webAudioBuffer))}addEventListener(e,t){!this.audio&&this.webAudioBuffer&&(this.audio=this.getAudioSourceNode(this.webAudioBuffer)),this.audio.addEventListener(e,t)}removeEventListener(e,t){!this.audio&&this.webAudioBuffer&&(this.audio=this.getAudioSourceNode(this.webAudioBuffer)),this.audio.removeEventListener(e,t)}getAudioSourceNode(e){const t=this.audioContext.createBufferSource();return t.buffer=e,t.connect(this.audioContext.destination),t}async preloadWebAudio(e){const t=await fetch(e),s=await t.arrayBuffer(),i=await this.audioContext.decodeAudioData(s),n=this.audioContext.createBufferSource();return n.buffer=i,n.connect(this.audioContext.destination),i}async preloadHTMLAudio(e){return new Promise(((t,s)=>{const i=new Audio(e);i.addEventListener("canplaythrough",(()=>{t(i)})),i.addEventListener("error",(e=>{s(e)})),i.addEventListener("abort",(e=>{s(e)}))}))}}const m=[d.AUDIO,d.IMAGE,d.VIDEO];class f{constructor(e){this.useWebaudio=e,this.video_buffers={},this.context=null,this.audio_buffers=[],this.preload_requests=[],this.img_cache={},this.preloadMap=new Map,this.microphone_recorder=null,this.camera_stream=null,this.camera_recorder=null,this.useWebaudio&&"undefined"!=typeof window&&void 0!==window.AudioContext&&(this.context=new AudioContext)}getVideoBuffer(e){return e.startsWith("blob:")&&(this.video_buffers[e]=e),this.video_buffers[e]}audioContext(){return this.context&&"running"!==this.context.state&&this.context.resume(),this.context}async getAudioPlayer(e){return this.audio_buffers[e]instanceof p||(this.audio_buffers[e]=new p(e,{useWebAudio:this.useWebaudio,audioContext:this.context}),await this.audio_buffers[e].load()),this.audio_buffers[e]}preloadAudio(e,t=()=>{},s=e=>{},i=e=>{}){e=n(e.flat());let r=0;if(0!=e.length)for(const n of e)this.audio_buffers[n]instanceof p?(r++,s(n),r==e.length&&t()):(this.audio_buffers[n]=new p(n,{useWebAudio:this.useWebaudio,audioContext:this.context}),this.audio_buffers[n].load().then((()=>{r++,s(n),r==e.length&&t()})).catch((e=>{i(e)})));else t()}preloadImages(e,t=()=>{},s=e=>{},i=e=>{}){e=n(e.flat());var r=0;if(0!==e.length)for(let n=0;n<e.length;n++){const a=new Image,o=e[n];a.onload=()=>{r++,s(o),r===e.length&&t()},a.onerror=e=>{i({source:o,error:e})},a.src=o,this.img_cache[o]=a,this.preload_requests.push(a)}else t()}preloadVideo(e,t=()=>{},s=e=>{},i=e=>{}){e=n(e.flat());let r=0;if(0!==e.length)for(const n of e){const a=this.video_buffers,o=new XMLHttpRequest;o.open("GET",n,!0),o.responseType="blob",o.onload=()=>{if(200===o.status||0===o.status){const i=o.response;a[n]=URL.createObjectURL(i),r++,s(n),r===e.length&&t()}},o.onerror=e=>{let t=e;404==o.status&&(t="404"),i({source:n,error:t})},o.onloadend=e=>{404==o.status&&i({source:n,error:"404"})},o.send(),this.preload_requests.push(o)}else t()}getAutoPreloadList(e){const t=Object.fromEntries(m.map((e=>[e,new Set]))),s=(e,i)=>{if(void 0!==e.timeline)for(const t of e.timeline)s(t,e.type??i);else if((e.type??i)?.info){const{name:s,parameters:n}=(e.type??i).info;this.preloadMap.has(s)||this.preloadMap.set(s,Object.fromEntries(Object.entries(n).filter((([e,{type:t,preload:s}])=>m.includes(t)&&(s??!0))).map((([e,{type:t}])=>[e,t]))));for(const[i,n]of Object.entries(this.preloadMap.get(s))){const s=e[i],r=t[n];if("string"==typeof s)r.add(s);else if(Array.isArray(s))for(const e of s.flat())"string"==typeof e&&r.add(e)}}};return s({timeline:e}),{images:[...t[d.IMAGE]],audio:[...t[d.AUDIO]],video:[...t[d.VIDEO]]}}cancelPreloads(){for(const e of this.preload_requests)e.onload=()=>{},e.onerror=()=>{},e.oncanplaythrough=()=>{},e.onabort=()=>{};this.preload_requests=[]}initializeMicrophoneRecorder(e){const t=new MediaRecorder(e);this.microphone_recorder=t}getMicrophoneRecorder(){return this.microphone_recorder}initializeCameraRecorder(e,t){const s={...t,mimeType:this.getCompatibleMimeType()||"video/webm"};this.camera_stream=e;const i=new MediaRecorder(e,s);this.camera_recorder=i}getCompatibleMimeType(){const e=["video/webm;codecs=vp9,opus","video/webm;codecs=vp8,opus","video/mp4;codecs=avc1.42E01E,mp4a.40.2","video/mp4;codecs=h264,aac","video/mp4;codecs=hevc,aac"];for(const t of e)if(MediaRecorder.isTypeSupported(t))return t;return null}getCameraStream(){return this.camera_stream}getCameraRecorder(){return this.camera_recorder}}class g{constructor(e,t){this.getDisplayContainerElement=e,this.setJsPsychTimeout=t}dispatchEvent(e){this.getDisplayContainerElement().dispatchEvent(e)}keyDown(e){this.dispatchEvent(new KeyboardEvent("keydown",{key:e}))}keyUp(e){this.dispatchEvent(new KeyboardEvent("keyup",{key:e}))}pressKey(e,t=0){t>0?this.setJsPsychTimeout((()=>{this.keyDown(e),this.keyUp(e)}),t):(this.keyDown(e),this.keyUp(e))}clickTarget(e,t=0){t>0?this.setJsPsychTimeout((()=>{e.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0})),e.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0})),e.dispatchEvent(new MouseEvent("click",{bubbles:!0}))}),t):(e.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0})),e.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0})),e.dispatchEvent(new MouseEvent("click",{bubbles:!0})))}fillTextInput(e,t,s=0){s>0?this.setJsPsychTimeout((()=>{e.value=t}),s):e.value=t}getValidKey(e){const t=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"," "];let s;if("NO_KEYS"==e)s=null;else if("ALL_KEYS"==e)s=t[Math.floor(Math.random()*t.length)];else{const t=e.flat();s=t[Math.floor(Math.random()*t.length)]}return s}mergeSimulationData(e,t){return{...e,...t?.data}}ensureSimulationDataConsistency(e,t){if(t.rt&&(t.rt=Math.round(t.rt)),e.trial_duration&&t.rt&&t.rt>e.trial_duration&&(t.rt=null,t.response&&(t.response=null),t.correct&&(t.correct=!1)),e.choices&&"NO_KEYS"==e.choices&&(t.rt&&(t.rt=null),t.response&&(t.response=null)),e.allow_response_before_complete&&e.sequence_reps&&e.frame_time){const s=e.sequence_reps*e.frame_time*e.stimuli.length;t.rt<s&&(t.rt=null,t.response=null)}}}class y{constructor(){this.timeout_handlers=[]}setTimeout(e,t){const s=window.setTimeout(e,t);return this.timeout_handlers.push(s),s}clearAllTimeouts(){for(const e of this.timeout_handlers)clearTimeout(e);this.timeout_handlers=[]}}function w(e,t,s=!1){const i=Array.isArray(e),n=Array.isArray(t);if(i)if(n){if(e.length!=t.length)if(console.warn("Unclear parameters given to randomization.repeat. Items and repetitions are unequal lengths. Behavior may not be as expected."),t.length<e.length){let s=[];for(let i=0;i<e.length;i++)s.push(t);t=s}else t=t.slice(0,e.length)}else{let s=[];for(let i=0;i<e.length;i++)s.push(t);t=s}else n?(t=[t[0]],console.log("Unclear parameters given to randomization.repeat. Multiple set sizes specified, but only one item exists to sample. Proceeding using the first set size.")):(e=[e],t=[t]);let r=[];for(let s=0;s<e.length;s++)for(let i=0;i<t[s];i++)null==e[s]||"object"!=typeof e[s]?r.push(e[s]):r.push(Object.assign({},e[s]));let a=b(r);return s&&(a=function(e){const t={};for(const s of e)for(const e of Object.keys(s))void 0===t[e]&&(t[e]=[]),t[e].push(s[e]);return t}(a)),a}function b(e){Array.isArray(e)||console.error("Argument to shuffle() must be an array.");const t=e.slice(0);let s,i,n=t.length;for(;n;)i=Math.floor(Math.random()*n--),s=t[n],t[n]=t[i],t[i]=s;return t}function v(e,t=!1){const s=e.length;if(1==s)return console.warn("shuffleAlternateGroups() was called with only one group. Defaulting to simple shuffle."),b(e[0]);let i=[];for(let e=0;e<s;e++)i.push(e);t&&(i=b(i));const n=[];let r=null;for(let t=0;t<s;t++)r=null===r?e[t].length:Math.min(r,e[t].length),n.push(b(e[t]));const a=[];for(let e=0;e<r;e++)for(let t=0;t<i.length;t++)a.push(n[i[t]][e]);return a}function _(e,t){return Array.isArray(e)||console.error("First argument to sampleWithoutReplacement() must be an array"),t>e.length&&console.error("Cannot take a sample larger than the size of the set of items to sample."),b(e).slice(0,t)}function E(e,t,s){Array.isArray(e)||console.error("First argument to sampleWithReplacement() must be an array");const i=[];if(void 0!==s){s.length!==e.length&&console.error("The length of the weights array must equal the length of the array to be sampled from.");let t=0;for(const e of s)t+=e;for(const e of s)i.push(e/t)}else for(let t=0;t<e.length;t++)i.push(1/e.length);const n=[i[0]];for(let e=1;e<i.length;e++)n.push(i[e]+n[e-1]);const r=[];for(let s=0;s<t;s++){const t=Math.random();let s=0;for(;t>n[s];)s++;r.push(e[s])}return r}function P(e,t){return function(){var e=0,t=0;for(;0===e;)e=Math.random();for(;0===t;)t=Math.random();return Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*t)}()*t+e}function T(e){return-Math.log(Math.random())/e}var A=Object.freeze({__proto__:null,factorial:function(e,t=1,s=!1){let i=[{}];for(const[t,s]of Object.entries(e)){const e=[];for(const n of s)for(const s of i)e.push({...s,[t]:n});i=e}return w(i,t,s)},randomID:function(e=32){let t="";const s="0123456789abcdefghjklmnopqrstuvwxyz";for(let i=0;i<e;i++)t+=s[Math.floor(35*Math.random())];return t},randomInt:function(e,t){if(t<e)throw new Error("Upper boundary must be greater than or equal to lower boundary");return e+Math.floor(Math.random()*(t-e+1))},randomWords:function(e){return t(e)},repeat:w,sampleBernoulli:function(e){return Math.random()<=e?1:0},sampleExGaussian:function(e,t,s,i=!1){let n=P(e,t)+T(s);if(i)for(;n<=0;)n=P(e,t)+T(s);return n},sampleExponential:T,sampleNormal:P,sampleWithReplacement:E,sampleWithoutReplacement:_,setSeed:function(e=Math.random().toString()){return Math.random=s(e),e},shuffle:b,shuffleAlternateGroups:v,shuffleNoRepeats:function(e,t){Array.isArray(e)||console.error("First argument to shuffleNoRepeats() must be an array."),void 0!==t&&"function"!=typeof t&&console.error("Second argument to shuffleNoRepeats() must be a function."),void 0===t&&(t=function(e,t){return e===t});const s=b(e);for(let e=0;e<s.length-1;e++)if(t(s[e],s[e+1])){let i=Math.floor(Math.random()*(s.length-2))+1;for(;t(s[e+1],s[i])||t(s[e+1],s[i+1])||t(s[e+1],s[i-1])||t(s[e],s[i]);)i=Math.floor(Math.random()*(s.length-2))+1;const n=s[i];s[i]=s[e+1],s[e+1]=n}return s}});function L(){const e={previewMode:!1,outsideTurk:!1,hitId:"INVALID_URL_PARAMETER",assignmentId:"INVALID_URL_PARAMETER",workerId:"INVALID_URL_PARAMETER",turkSubmitTo:"INVALID_URL_PARAMETER"},t=function(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");const s=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return null==s?"":s[1]},s=t(window.location.href,"assignmentId")?window.location.href:document.referrer;return["assignmentId","hitId","workerId","turkSubmitTo"].map((function(i){e[i]=unescape(t(s,i))})),e.previewMode="ASSIGNMENT_ID_NOT_AVAILABLE"==e.assignmentId,e.outsideTurk=!e.previewMode&&""===e.hitId&&""==e.assignmentId&&""==e.workerId,e}var C=Object.freeze({__proto__:null,submitToTurk:function(e){const t=L(),s=t.assignmentId,i=t.turkSubmitTo;if(!s||!i)return;const n=document.createElement("form");n.method="POST",n.action=i+"/mturk/externalSubmit?assignmentId="+s;for(const t in e)if(e.hasOwnProperty(t)){const s=document.createElement("input");s.type="hidden",s.name=t,s.id=t,s.value=e[t],n.appendChild(s)}document.body.appendChild(n),n.submit()},turkInfo:L});class x{constructor(e,t){this.containerElement=e,this.message=t,this._progress=0,this.setupElements()}setupElements(){this.messageSpan=document.createElement("span"),this.innerDiv=document.createElement("div"),this.innerDiv.id="jspsych-progressbar-inner",this.update();const e=document.createElement("div");e.id="jspsych-progressbar-outer",e.appendChild(this.innerDiv),this.containerElement.appendChild(this.messageSpan),this.containerElement.appendChild(e)}update(){this.innerDiv.style.width=100*this._progress+"%","function"==typeof this.message?this.messageSpan.innerHTML=this.message(this._progress):this.messageSpan.innerHTML=this.message}set progress(e){if("number"!=typeof e||e<0||e>1)throw new Error("jsPsych.progressBar.progress must be a number between 0 and 1");this._progress=e,this.update()}get progress(){return this._progress}}class I{constructor(e){this.name=e}}const S=["timeline","timeline_variables","name","repetitions","loop_function","conditional_function","randomize_order","sample","on_timeline_start","on_timeline_finish"];function j(e){return Boolean(e.timeline)||Array.isArray(e)}var O=(e=>(e[e.PENDING=0]="PENDING",e[e.RUNNING=1]="RUNNING",e[e.PAUSED=2]="PAUSED",e[e.COMPLETED=3]="COMPLETED",e[e.ABORTED=4]="ABORTED",e))(O||{});class M{constructor(){this.reset()}reset(){this.promise=new Promise((e=>{this.resolvePromise=e}))}get(){return this.promise}resolve(e){this.resolvePromise(e),this.reset()}}function N([e,...t]){let s=e??"";for(const e of t)s+=Number.isNaN(Number.parseInt(e))?`.${e}`:`[${e}]`;return s}class R{constructor(){this.cache=new Map}static lookupChild(e,t){let s,i=!1;return Number.isNaN(Number.parseInt(t))?Object.hasOwn(e,t)&&(i=!0,s=e[t]):Number.parseInt(t)<e.length&&(i=!0,s=e[t]),{doesPathExist:i,value:s}}get(e){return this.cache.get(e.join("."))}has(e){return this.cache.has(e.join("."))}initialize(e){this.rootObject=e,this.cache.set("",e)}reset(){this.cache.clear(),this.cache.set("",this.rootObject)}set(e,t){this.cache.set(e.join("."),t)}lookup(e){if(this.has(e))return{doesPathExist:!0,value:this.get(e)};const t=e=>{const s=e.slice(0,-1),i=e[e.length-1];if(!this.has(s)&&s.length>0&&!t(s).doesPathExist)return{doesPathExist:!1};const n=this.get(s);if("object"!=typeof(r=n)||null===r)return{doesPathExist:!1};var r;const a=R.lookupChild(n,i);return a.doesPathExist&&this.set(e,a.value),a};return t(e)}}class D{constructor(e){this.dependencies=e,this.status=O.PENDING,this.parameterValueCache=new R}getStatus(){return this.status}initializeParameterValueCache(){this.parameterValueCache.initialize(this.description)}resetParameterValueCache(){this.parameterValueCache.reset(),this.parent?.resetParameterValueCache()}getParameterValue(e,t={}){const{evaluateFunctions:s=!0,recursive:i=!0,cacheResult:n=!0,replaceResult:r}=t;"string"==typeof e&&(e=[e]);let{doesPathExist:a,value:o}=this.parameterValueCache.lookup(e);return!a&&i&&this.parent&&(o=this.parent.getParameterValue(e,t)),"function"==typeof o&&s&&(o=o()),o instanceof I&&(o=this.evaluateTimelineVariable(o)),"function"==typeof r&&(o=r(o)),n&&this.parameterValueCache.set(e,o),o}getDataParameter(){const e=this.getParameterValue("data",{recursive:!1});return{...Object.fromEntries("object"==typeof e?Object.keys(e).map((e=>[e,this.getParameterValue(["data",e])])):[]),...this.parent?.getDataParameter()}}}class V extends D{constructor(e,t,s){if(super(e),this.description=t,this.parent=s,this.onLoad=()=>{this.runParameterCallback("on_load"),this.dependencies.runOnLoadExtensionCallbacks(this.getParameterValue("extensions"))},this.initializeParameterValueCache(),this.trialObject=r(t),this.pluginClass=this.getParameterValue("type",{evaluateFunctions:!1}),this.pluginInfo=this.pluginClass?.info,!this.pluginInfo)throw new Error("Plugin not recognized. Please provide a valid plugin using the 'type' parameter.");"version"in this.pluginInfo||"data"in this.pluginInfo?"version"in this.pluginInfo?"data"in this.pluginInfo||console.warn(this.pluginInfo.name,"is missing the 'data' field. Please update plugin as 'data' will be required in v9. See https://www.jspsych.org/latest/developers/plugin-development/ for more details."):console.warn(this.pluginInfo.name,"is missing the 'version' field. Please update plugin as 'version' will be required in v9. See https://www.jspsych.org/latest/developers/plugin-development/ for more details."):console.warn(this.pluginInfo.name,"is missing the 'version' and 'data' fields. Please update plugin as 'version' and 'data' will be required in v9. See https://www.jspsych.org/latest/developers/plugin-development/ for more details.")}async run(){this.status=O.RUNNING,this.processParameters(),this.onStart(),this.addCssClasses(),this.pluginInstance=this.dependencies.instantiatePlugin(this.pluginClass),this.result=this.processResult(await this.executeTrial()),this.dependencies.onTrialResultAvailable(this),this.status=O.COMPLETED,await this.onFinish(),this.removeCssClasses();const e=this.getParameterValue("post_trial_gap")??this.dependencies.getDefaultIti();var t;0!==e&&"data-only"!==this.dependencies.getSimulationMode()&&await(t=e,new Promise((e=>setTimeout(e,t)))),this.resetParameterValueCache()}async executeTrial(){const e=this.dependencies.finishTrialPromise.get();let t=!1;e.then((()=>{t=!0}));const{trialReturnValue:s,hasTrialBeenSimulated:i}=this.invokeTrialMethod();let n;var r;return(r=s)&&"function"==typeof r.then?(n=await Promise.race([s,e]),t&&(n=await e)):(i||this.onLoad(),n=await e),this.cleanupTrial(),n}invokeTrialMethod(){const e=this.dependencies.getSimulationMode();if(e&&"function"==typeof this.pluginInstance.simulate){const t=this.getSimulationOptions();if(!1!==t.simulate)return{hasTrialBeenSimulated:!0,trialReturnValue:this.pluginInstance.simulate(this.trialObject,t.mode??e,t,this.onLoad)}}return{hasTrialBeenSimulated:!1,trialReturnValue:this.pluginInstance.trial(this.dependencies.getDisplayElement(),this.trialObject,this.onLoad)}}cleanupTrial(){this.dependencies.clearAllTimeouts(),this.dependencies.getDisplayElement().innerHTML=""}addCssClasses(){const e=this.getParameterValue("css_classes"),t=this.dependencies.getDisplayElement().classList;"string"==typeof e?t.add(e):Array.isArray(e)&&t.add(...e)}removeCssClasses(){const e=this.getParameterValue("css_classes");e&&this.dependencies.getDisplayElement().classList.remove(..."string"==typeof e?[e]:e)}processResult(e){e||(e={});for(const[t,s]of Object.entries(this.getParameterValue("save_trial_parameters")??{}))if(this.pluginInfo.parameters[t])if(s&&!Object.hasOwn(e,t)){let s=this.trialObject[t];"function"==typeof s&&(s=s.toString()),e[t]=s}else!s&&Object.hasOwn(e,t)&&delete e[t];else console.warn(`Non-existent parameter "${t}" specified in save_trial_parameters.`);e={...this.getDataParameter(),...e,trial_type:this.pluginInfo.name,trial_index:this.index,plugin_version:this.pluginInfo.version?this.pluginInfo.version:null};const t=this.getParameterValue("save_timeline_variables");return!0===t?e.timeline_variables={...this.parent.getAllTimelineVariables()}:Array.isArray(t)&&(e.timeline_variables=Object.fromEntries(Object.entries(this.parent.getAllTimelineVariables()).filter((([e,s])=>t.includes(e))))),e}runParameterCallback(e,...t){const s=this.getParameterValue(e,{evaluateFunctions:!1});if(s)return s(...t)}onStart(){this.dependencies.onTrialStart(this),this.runParameterCallback("on_start",this.trialObject),this.dependencies.runOnStartExtensionCallbacks(this.getParameterValue("extensions"))}async onFinish(){const e=await this.dependencies.runOnFinishExtensionCallbacks(this.getParameterValue("extensions"));Object.assign(this.result,e),await Promise.resolve(this.runParameterCallback("on_finish",this.getResult())),this.dependencies.onTrialFinished(this)}evaluateTimelineVariable(e){return this.parent?.evaluateTimelineVariable(e)}getParameterValue(e,t={}){return S.includes("string"==typeof e?e:e[0])&&(t.recursive=!1),super.getParameterValue(e,t)}getSimulationOptions(){const e=this.getParameterValue("simulation_options",{replaceResult:(e={})=>{if("string"==typeof e){const t=this.dependencies.getGlobalSimulationOptions();e=t[e]??t.default??{}}return a(r(this.dependencies.getGlobalSimulationOptions().default),r(e))}});return void 0===e?{}:(e.mode=this.getParameterValue(["simulation_options","mode"]),e.simulate=this.getParameterValue(["simulation_options","simulate"]),e.data=this.getParameterValue(["simulation_options","data"]),"object"==typeof e.data&&(e.data=Object.fromEntries(Object.keys(e.data).map((e=>[e,this.getParameterValue(["simulation_options","data",e])])))),e)}getResult(){return!1===this.getParameterValue("record_data")?void 0:this.result}getResults(){const e=this.getResult();return e?[e]:[]}processParameters(){const e=(t,s,i=[])=>{for(const[n,r]of Object.entries(s)){const s=[...i,n];let a=this.getParameterValue(s,{evaluateFunctions:r.type!==d.FUNCTION,replaceResult:e=>{if(void 0===e){if(void 0===r.default)throw new Error(`You must specify a value for the "${N(s)}" parameter in the "${this.pluginInfo.name}" plugin.`);return r.default}return e}});if(r.array&&!Array.isArray(a)){const e=N(s);throw new Error(`A non-array value (\`${a}\`) was provided for the array parameter "${e}" in the "${this.pluginInfo.name}" plugin. Please make sure that "${e}" is an array.`)}r.type===d.COMPLEX&&r.nested&&(r.array?a=a.map(((t,i)=>{const n=[...s,i.toString()],a=this.getParameterValue(n);return e(a,r.nested,n),a})):e(a,r.nested,s)),t[n]=a}},t=r(this.description);e(t,this.pluginInfo.parameters),this.trialObject=t}getLatestNode(){return this}getActiveTimelineByName(e){}}class k extends D{constructor(e,t,s){super(e),this.parent=s,this.children=[],this.shouldAbort=!1,this.resumePromise=new M,this.description=Array.isArray(t)?{timeline:t}:t,this.initializeParameterValueCache()}async run(){void 0===this.index&&(this.index=0),this.status=O.RUNNING;const{conditional_function:e,loop_function:t,repetitions:s=1}=this.description;let i=this.generateTimelineVariableOrder();this.setCurrentTimelineVariablesByIndex(i[0]);let n,r=!0;if(!e||e()){this.onStart();for(let e=0;e<s;e++)do{n=[],r?r=!1:i=this.generateTimelineVariableOrder();for(const e of i){this.setCurrentTimelineVariablesByIndex(e);for(const e of this.description.timeline){const t=this.instantiateChildNode(e),s=this.currentChild;if(this.currentChild=t,t.index=s?s.getLatestNode().index+1:this.index,await t.run(),this.status===O.PAUSED&&await this.resumePromise.get(),this.shouldAbort)return void(this.status=O.ABORTED);n.push(...this.currentChild.getResults())}}}while(t&&t(new h(n)));this.onFinish()}this.status=O.COMPLETED}onStart(){this.description.on_timeline_start&&this.description.on_timeline_start()}onFinish(){this.description.on_timeline_finish&&this.description.on_timeline_finish()}pause(){this.currentChild instanceof k&&this.currentChild.pause(),this.status=O.PAUSED}resume(){this.status==O.PAUSED&&(this.currentChild instanceof k&&this.currentChild.resume(),this.status=O.RUNNING,this.resumePromise.resolve())}abort(){this.status!==O.RUNNING&&this.status!==O.PAUSED||(this.currentChild instanceof k&&this.currentChild.abort(),this.shouldAbort=!0,this.status===O.PAUSED&&this.resume())}instantiateChildNode(e){const t=j(e)?new k(this.dependencies,e,this):new V(this.dependencies,e,this);return this.children.push(t),t}setCurrentTimelineVariablesByIndex(e){this.currentTimelineVariables={...this.parent?.getAllTimelineVariables(),...null===e?void 0:this.description.timeline_variables[e]}}generateTimelineVariableOrder(){const e=this.description.timeline_variables?.length;if(!e)return[null];let t=[...Array(e).keys()];const s=this.description.sample;if(s)switch(s.type){case"custom":t=s.fn(t);break;case"with-replacement":t=E(t,s.size,s.weights);break;case"without-replacement":t=_(t,s.size);break;case"fixed-repetitions":t=w(t,s.size);break;case"alternate-groups":t=v(s.groups,s.randomize_group_order);break;default:throw new Error(`Invalid type "${s.type}" in timeline sample parameters. Valid options for type are "custom", "with-replacement", "without-replacement", "fixed-repetitions", and "alternate-groups"`)}return this.description.randomize_order&&(t=b(t)),t}getAllTimelineVariables(){return this.currentTimelineVariables}evaluateTimelineVariable(e){if(this.currentTimelineVariables?.hasOwnProperty(e.name))return this.currentTimelineVariables[e.name];throw new Error(`Timeline variable ${e.name} not found.`)}getResults(){const e=[];for(const t of this.children)if(t instanceof V){const s=t.getResult();s&&e.push(s)}else t instanceof k&&e.push(...t.getResults());return e}getNaiveProgress(){if(this.status===O.PENDING)return 0;const e=this.getLatestNode();if(!e)return 1;let t=e.index;return e.getStatus()===O.COMPLETED&&t++,Math.min(t/this.getNaiveTrialCount(),1)}getNaiveTrialCount(){const e=t=>{const s=t=>t.map((t=>e(t))).reduce(((e,t)=>e+t));if(Array.isArray(t))return s(t);if(function(e){return!j(e)}(t))return 1;if(j(t)){let e=t.timeline_variables?.length||1;switch(t.sample?.type){case"with-replacement":case"without-replacement":e=t.sample.size;break;case"fixed-repetitions":e*=t.sample.size;break;case"alternate-groups":e=t.sample.groups.map((e=>e.length)).reduce(((e,t)=>e+t),0)}return s(t.timeline)*(t.repetitions??1)*e}return 0};return e(this.description)}getLatestNode(){return this.currentChild?.getLatestNode()??this}getActiveTimelineByName(e){return this.description.name===e?this:this.currentChild?.getActiveTimelineByName(e)}}class B{constructor(t){this.turk=C,this.randomization=A,this.utils=o,this.citation={apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, \tauthor = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, \tjournal = {Journal of Open Source Software}, \tdoi = {10.21105/joss.05351}, \tissn = {2475-9066}, \tnumber = {85}, \tyear = {2023}, \tmonth = {may 11}, \tpages = {5351}, \tpublisher = {Open Journals}, \ttitle = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, \turl = {https://joss.theoj.org/papers/10.21105/joss.05351}, \tvolume = {8}, }  '},this.options={},this.isFileProtocolUsed=!1,this.finishTrialPromise=new M,this.timelineDependencies={onTrialStart:e=>{this.options.on_trial_start(e.trialObject),this.getDisplayContainerElement().focus(),this.getDisplayElement().scrollTop=0},onTrialResultAvailable:e=>{const t=e.getResult();t&&(t.time_elapsed=this.getTotalTime(),this.data.write(e))},onTrialFinished:e=>{const t=e.getResult();this.options.on_trial_finish(t),t&&this.options.on_data_update(t),this.progressBar&&this.options.auto_update_progress_bar&&(this.progressBar.progress=this.timeline.getNaiveProgress())},runOnStartExtensionCallbacks:e=>this.extensionManager.onStart(e),runOnLoadExtensionCallbacks:e=>this.extensionManager.onLoad(e),runOnFinishExtensionCallbacks:e=>this.extensionManager.onFinish(e),getSimulationMode:()=>this.simulationMode,getGlobalSimulationOptions:()=>this.simulationOptions,instantiatePlugin:e=>new e(this),getDisplayElement:()=>this.getDisplayElement(),getDefaultIti:()=>this.getInitSettings().default_iti,finishTrialPromise:this.finishTrialPromise,clearAllTimeouts:()=>this.pluginAPI.clearAllTimeouts()},this.extensionManagerDependencies={instantiateExtension:e=>new e(this)},this.dataDependencies={getProgress:()=>({time:this.getTotalTime(),trial:this.timeline?.getLatestNode().index??0}),onInteractionRecordAdded:e=>{this.options.on_interaction_data_update(e)},getDisplayElement:()=>this.getDisplayElement()},t={display_element:void 0,on_finish:()=>{},on_trial_start:()=>{},on_trial_finish:()=>{},on_data_update:()=>{},on_interaction_data_update:()=>{},on_close:()=>{},use_webaudio:!0,show_progress_bar:!1,message_progress_bar:"Completion Progress",auto_update_progress_bar:!0,default_iti:0,minimum_valid_rt:0,experiment_width:null,override_safe_mode:!1,case_sensitive_responses:!1,extensions:[],...t},this.options=t,e(this),"file:"!=window.location.protocol||!1!==t.override_safe_mode&&void 0!==t.override_safe_mode||(t.use_webaudio=!1,this.isFileProtocolUsed=!0,console.warn("jsPsych detected that it is running via the file:// protocol and not on a web server. To prevent issues with cross-origin requests, Web Audio and video preloading have been disabled. If you would like to override this setting, you can set 'override_safe_mode' to 'true' in initJsPsych. For more information, see: https://www.jspsych.org/overview/running-experiments")),this.data=new u(this.dataDependencies),this.pluginAPI=function(t){const s=t.getInitSettings(),i=new c(t.getDisplayContainerElement,s.case_sensitive_responses,s.minimum_valid_rt),n=new y,r=new f(s.use_webaudio),a=new g(t.getDisplayContainerElement,n.setTimeout.bind(n));return Object.assign({},...[i,n,r,a].map((t=>e(t))))}(this),this.extensionManager=new i(this.extensionManagerDependencies,t.extensions)}version(){return"8.2.2"}async run(e){void 0===e&&console.error("No timeline declared in jsPsych.run(). Cannot start experiment."),0===e.length&&console.error("No trials have been added to the timeline (the timeline is an empty array). Cannot start experiment."),this.timeline=new k(this.timelineDependencies,e),await this.prepareDom(),await this.extensionManager.initializeExtensions(),document.documentElement.setAttribute("jspsych","present"),this.experimentStartTime=new Date,await this.timeline.run(),await Promise.resolve(this.options.on_finish(this.data.get())),this.endMessage&&(this.getDisplayElement().innerHTML=this.endMessage),this.data.removeInteractionListeners()}async simulate(e,t="data-only",s={}){this.simulationMode=t,this.simulationOptions=s,await this.run(e)}getProgress(){return{total_trials:this.timeline?.getNaiveTrialCount(),current_trial_global:this.timeline?.getLatestNode().index??0,percent_complete:100*this.timeline?.getNaiveProgress()}}getStartTime(){return this.experimentStartTime}getTotalTime(){return this.experimentStartTime?(new Date).getTime()-this.experimentStartTime.getTime():0}getDisplayElement(){return this.displayElement}getDisplayContainerElement(){return this.displayContainerElement}abortExperiment(e,t={}){this.endMessage=e,this.timeline.abort(),this.pluginAPI.cancelAllKeyboardResponses(),this.pluginAPI.clearAllTimeouts(),this.finishTrial(t)}abortCurrentTimeline(){let e=this.timeline?.getLatestNode();e instanceof V&&(e=e.parent),e instanceof k&&e.abort()}abortTimelineByName(e){const t=this.timeline?.getActiveTimelineByName(e);t&&t.abort()}getCurrentTrial(){const e=this.timeline?.getLatestNode();if(e instanceof V)return e.description}getInitSettings(){return this.options}timelineVariable(e){return new I(e)}evaluateTimelineVariable(e){return this.timeline?.getLatestNode()?.evaluateTimelineVariable(new I(e))}pauseExperiment(){this.timeline?.pause()}resumeExperiment(){this.timeline?.resume()}getSafeModeStatus(){return this.isFileProtocolUsed}getTimeline(){return this.timeline?.description.timeline}getCitations(e=[],t="apa"){if(t=t.toLowerCase(),Array.isArray(e)){if(["apa","bibtex"].includes(t)){const s=this.citation[t],i=new Set([s]);for(const s of e)try{const e=s.info.citations[t];i.add(e)}catch{console.error(`${s} does not have citation in ${t} format.`)}return Array.from(i).join("\n")}throw new Error("Unsupported citation format")}throw new Error("Expected array of plugins/extensions")}get extensions(){return this.extensionManager?.extensions??{}}async prepareDom(){"complete"!==document.readyState&&await new Promise((e=>{window.addEventListener("load",e)}));const e=this.options;if(void 0===e.display_element){let t=document.body;t||(t=document.createElement("body"),document.documentElement.appendChild(t)),document.querySelector("html").style.height="100%",t.style.margin="0px",t.style.height="100%",t.style.width="100%",e.display_element=t}else{const t=e.display_element instanceof Element?e.display_element:document.querySelector("#"+e.display_element);null===t?console.error("The display_element specified in initJsPsych() does not exist in the DOM."):e.display_element=t}const t=document.createElement("div");t.id="jspsych-content";const s=document.createElement("div");if(s.className="jspsych-content-wrapper",s.appendChild(t),this.displayContainerElement=e.display_element,this.displayContainerElement.appendChild(s),this.displayElement=t,null!==e.experiment_width&&(this.displayElement.style.width=e.experiment_width+"px"),e.display_element.tabIndex=0,this.displayContainerElement.classList.add("jspsych-display-element"),this.displayElement.classList.add("jspsych-content"),this.data.createInteractionListeners(),window.addEventListener("beforeunload",e.on_close),this.options.show_progress_bar){const e=document.createElement("div");e.id="jspsych-progressbar-container",this.progressBar=new x(e,this.options.message_progress_bar),this.getDisplayContainerElement().insertAdjacentElement("afterbegin",e)}}finishTrial(e){this.finishTrialPromise.resolve(e)}}class U extends Error{constructor(e="The global `jsPsych` variable is no longer available in jsPsych v7."){super(`${e} Please follow the migration guide at https://www.jspsych.org/7.0/support/migration-v7/ to update your experiment.`),this.name="MigrationError"}}function K(e){const t=new B(e);return Object.defineProperties(t,Object.fromEntries(Object.entries({init:"`jsPsych.init()` was replaced by `initJsPsych()` in jsPsych v7.",ALL_KEYS:'jsPsych.ALL_KEYS was replaced by the "ALL_KEYS" string in jsPsych v7.',NO_KEYS:'jsPsych.NO_KEYS was replaced by the "NO_KEYS" string in jsPsych v7.',currentTimelineNodeID:"`currentTimelineNodeID()` was renamed to `getCurrentTimelineNodeID()` in jsPsych v7.",progress:"`progress()` was renamed to `getProgress()` in jsPsych v7.",startTime:"`startTime()` was renamed to `getStartTime()` in jsPsych v7.",totalTime:"`totalTime()` was renamed to `getTotalTime()` in jsPsych v7.",currentTrial:"`currentTrial()` was renamed to `getCurrentTrial()` in jsPsych v7.",initSettings:"`initSettings()` was renamed to `getInitSettings()` in jsPsych v7.",allTimelineVariables:"`allTimelineVariables()` was renamed to `getAllTimelineVariables()` in jsPsych v7."}).map((([e,t])=>[e,{get(){throw new U(t)}}])))),t}window.jsPsych={get init(){throw new U("`jsPsych.init()` was replaced by `initJsPsych()` in jsPsych v7.")},get data(){throw new U},get randomization(){throw new U},get turk(){throw new U},get pluginAPI(){throw new U},get ALL_KEYS(){throw new U('jsPsych.ALL_KEYS was replaced by the "ALL_KEYS" string in jsPsych v7.')},get NO_KEYS(){throw new U('jsPsych.NO_KEYS was replaced by the "NO_KEYS" string in jsPsych v7.')}},"undefined"!=typeof window&&window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext);export{h as DataCollection,B as JsPsych,d as ParameterType,K as initJsPsych};export default null;
//# sourceMappingURL=/sm/745462c2dc39018b23c08d954030eda1a90c9703c4a47c21832b2366703d6216.map